{"ast":null,"code":"var _temp,\n    _jsxFileName = \"/home/marco/Documents/Job/Interviews/ProctorExam/Pokemon-list/client/src/components/pokemon/PokemonContainer.jsx\";\n\nimport React, { PureComponent } from 'react';\nimport request from 'superagent';\nimport PokemonList from './PokemonList';\nimport PokemonDetails from './PokemonDetails';\nimport PokemonSearchForm from './PokemonSearchForm';\nimport UserSection from './UserSection';\nimport { logout } from '../../actions/auth';\nimport Grid from \"@material-ui/core/Grid\";\nimport { withStyles } from \"@material-ui/core/styles\";\nimport { connect } from 'react-redux';\nimport jsPDF from 'jspdf'; // const baseUrl = process.env.REACT_APP_API_URL || \"http://localhost:4001\";\n\nconst baseUrl = process.env.REACT_APP_API_URL;\n\nconst styles = theme => ({\n  root: {\n    flexGrow: 1\n  },\n  container: {\n    padding: 24\n  },\n  paper: {\n    padding: 32\n  },\n  user: {\n    marginRight: 32\n  },\n  textField: {\n    marginLeft: theme.spacing(1),\n    marginRight: theme.spacing(1)\n  }\n});\n\nconst PokemonContainer = withStyles(styles)((_temp = class extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    this.showDetails = pokemonName => {\n      request(\"\".concat(baseUrl, \"/pokemons/\").concat(pokemonName)).then(response => {\n        this.checkFavorite(response.body.pokemon, this.state.favorites);\n        this.setState({\n          selected: response.body.pokemon\n        });\n      });\n    };\n\n    this.changeFavorite = event => {\n      const pokemonName = this.state.selected.name;\n      this.setState({\n        favorite: event.target.checked\n      });\n\n      if (event.target.checked) {\n        //Add element to favorites\n        this.setState(prevState => ({\n          favorites: [...prevState.favorites, prevState.selected.id]\n        }));\n        request.post(\"\".concat(baseUrl, \"/users/\").concat(this.props.currentUser.userId)).query({\n          name: pokemonName\n        }).then(response => {\n          console.log(\"Pokemon \".concat(pokemonName, \" added as favorite\"));\n        });\n      } else {\n        //Remove element from favorites\n        this.setState({\n          favorites: this.state.favorites.filter(fav => fav !== this.state.selected.id)\n        });\n        request.del(\"\".concat(baseUrl, \"/users/\").concat(this.props.currentUser.userId)).query({\n          name: pokemonName\n        }).then(response => {\n          console.log(\"Pokemon \".concat(pokemonName, \" removed from favorites\"));\n        });\n      }\n    };\n\n    this.checkFavorite = selected => {\n      request(\"\".concat(baseUrl, \"/pokemons/favorites/\").concat(this.props.currentUser.userId)).then(response => {\n        const favorites = response.body.favorites.map(elem => elem.pokemonId);\n\n        if (favorites.includes(selected.id)) {\n          this.setState({\n            favorite: true\n          });\n        } else {\n          this.setState({\n            favorite: false\n          });\n        }\n      });\n    };\n\n    this.loggingOut = () => {\n      this.props.logout();\n    };\n\n    this.generatePdf = () => {\n      const doc = new jsPDF();\n      doc.text(\"Id: \".concat(this.state.selected.id), 10, 10);\n      doc.text(\"Name: \".concat(this.state.selected.name), 10, 20);\n      doc.text(\"Weight: \".concat(this.state.selected.weight), 10, 30);\n      doc.text(\"Height: \".concat(this.state.selected.height), 10, 40);\n      doc.text(\"Base experience: \".concat(this.state.selected.base_experience), 10, 50);\n      doc.text(\"Image URL: \".concat(this.state.selected.image), 10, 60, {\n        maxWidth: \"180\"\n      });\n      doc.text(\"Favorite: \".concat(this.state.favorite), 10, 80);\n      doc.save('pokemon_details.pdf');\n    };\n\n    this.state = {\n      pokemons: null,\n      selected: null,\n      favorites: null,\n      favorite: false\n    };\n    this.handleChange = this.handleChange.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.loggingOut = this.loggingOut.bind(this);\n  }\n\n  componentDidMount() {\n    //Get all pokemons\n    request(\"\".concat(baseUrl, \"/pokemons\")).then(response => {\n      this.setState({\n        pokemons: response.body.pokemons\n      });\n    }).then(() => {\n      request(\"\".concat(baseUrl, \"/pokemons/favorites/\").concat(this.props.currentUser.userId)).then(response => {\n        this.setState({\n          favorites: response.body.favorites.map(elem => elem.pokemonId)\n        });\n      });\n    });\n  }\n\n  handleChange(event) {\n    this.setState({\n      [event.target.name]: event.target.value\n    });\n  }\n\n  handleSubmit(event) {\n    event.preventDefault();\n    request(\"\".concat(baseUrl, \"/pokemons\")).query({\n      name: this.state.searchKey\n    }).then(response => {\n      this.setState({\n        pokemons: response.body.pokemons\n      });\n    });\n  }\n\n  render() {\n    const classes = this.props.classes;\n    if (!this.state.pokemons) return \"Loading...\";\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153\n      },\n      __self: this\n    }, React.createElement(Grid, {\n      container: true,\n      className: classes.container,\n      justify: \"space-evenly\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 154\n      },\n      __self: this\n    }, React.createElement(Grid, {\n      item: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155\n      },\n      __self: this\n    }, React.createElement(Grid, {\n      container: true,\n      className: classes.container,\n      direction: \"column\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156\n      },\n      __self: this\n    }, React.createElement(Grid, {\n      item: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157\n      },\n      __self: this\n    }, React.createElement(PokemonSearchForm, {\n      handleSubmit: this.handleSubmit,\n      handleChange: this.handleChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158\n      },\n      __self: this\n    })), React.createElement(Grid, {\n      item: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161\n      },\n      __self: this\n    }, React.createElement(Grid, {\n      container: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162\n      },\n      __self: this\n    }, React.createElement(PokemonList, {\n      pokemons: this.state.pokemons,\n      showDetails: this.showDetails,\n      favorites: this.state.favorites,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163\n      },\n      __self: this\n    }))))), React.createElement(Grid, {\n      item: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171\n      },\n      __self: this\n    }, React.createElement(Grid, {\n      container: true,\n      direction: \"column\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172\n      },\n      __self: this\n    }, React.createElement(Grid, {\n      item: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173\n      },\n      __self: this\n    }, React.createElement(UserSection, {\n      loggingOut: this.loggingOut,\n      currentUser: this.props.currentUser,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174\n      },\n      __self: this\n    })), React.createElement(Grid, {\n      item: true,\n      className: classes.paper,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177\n      },\n      __self: this\n    }, React.createElement(PokemonDetails, {\n      selected: this.state.selected,\n      changeFavorite: this.changeFavorite,\n      favorite: this.state.favorite,\n      currentUser: this.props.currentUser,\n      generatePdf: this.generatePdf,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178\n      },\n      __self: this\n    }))))));\n  }\n\n}, _temp));\n\nconst mapStateToProps = function (state) {\n  return {\n    currentUser: state.currentUser,\n    error: state.login.error\n  };\n};\n\nconst mapDispatchToProps = {\n  logout\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(PokemonContainer);","map":{"version":3,"sources":["/home/marco/Documents/Job/Interviews/ProctorExam/Pokemon-list/client/src/components/pokemon/PokemonContainer.jsx"],"names":["React","PureComponent","request","PokemonList","PokemonDetails","PokemonSearchForm","UserSection","logout","Grid","withStyles","connect","jsPDF","baseUrl","process","env","REACT_APP_API_URL","styles","theme","root","flexGrow","container","padding","paper","user","marginRight","textField","marginLeft","spacing","PokemonContainer","constructor","props","showDetails","pokemonName","then","response","checkFavorite","body","pokemon","state","favorites","setState","selected","changeFavorite","event","name","favorite","target","checked","prevState","id","post","currentUser","userId","query","console","log","filter","fav","del","map","elem","pokemonId","includes","loggingOut","generatePdf","doc","text","weight","height","base_experience","image","maxWidth","save","pokemons","handleChange","bind","handleSubmit","componentDidMount","value","preventDefault","searchKey","render","classes","mapStateToProps","error","login","mapDispatchToProps"],"mappings":"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","sourcesContent":["import React, { PureComponent } from 'react'\nimport request from 'superagent'\nimport PokemonList from './PokemonList'\nimport PokemonDetails from './PokemonDetails'\nimport PokemonSearchForm from './PokemonSearchForm'\nimport UserSection from './UserSection'\nimport { logout } from '../../actions/auth'\nimport Grid from \"@material-ui/core/Grid\";\nimport { withStyles } from \"@material-ui/core/styles\";\nimport { connect } from 'react-redux'\nimport jsPDF from 'jspdf';\n\n// const baseUrl = process.env.REACT_APP_API_URL || \"http://localhost:4001\";\nconst baseUrl = process.env.REACT_APP_API_URL\n\nconst styles = (theme) => ({\n  root: {\n    flexGrow: 1\n  },\n  container: {\n    padding: 24\n  },\n  paper: {\n    padding: 32\n  },\n  user: {\n    marginRight: 32\n  },\n  textField: {\n    marginLeft: theme.spacing(1),\n    marginRight: theme.spacing(1),\n  },\n});\n\n\nconst PokemonContainer = withStyles(styles)(\n  class extends PureComponent {\n\n    constructor(props) {\n      super(props)\n      this.state = {\n        pokemons: null,\n        selected: null,\n        favorites: null,\n        favorite: false\n      }\n      this.handleChange = this.handleChange.bind(this)\n      this.handleSubmit = this.handleSubmit.bind(this)\n      this.loggingOut = this.loggingOut.bind(this)\n    }\n\n    componentDidMount() {\n      //Get all pokemons\n      request(`${baseUrl}/pokemons`)\n        .then(response => {\n          this.setState({ pokemons: response.body.pokemons })\n        })\n        .then(() => {\n          request(`${baseUrl}/pokemons/favorites/${this.props.currentUser.userId}`)\n            .then(response => {\n              this.setState({ favorites: response.body.favorites.map(elem => (elem.pokemonId)) })\n            })\n        })\n\n    }\n\n    handleChange(event) {\n      this.setState({ [event.target.name]: event.target.value })\n    }\n\n    handleSubmit(event) {\n      event.preventDefault()\n      request(`${baseUrl}/pokemons`)\n        .query({ name: this.state.searchKey })\n        .then(response => {\n          this.setState({ pokemons: response.body.pokemons })\n        })     \n    }\n\n    showDetails = (pokemonName) => {\n      request(`${baseUrl}/pokemons/${pokemonName}`)\n        .then(response => {\n          this.checkFavorite(response.body.pokemon, this.state.favorites)\n          this.setState({ selected: response.body.pokemon })\n        })\n    }\n\n    changeFavorite = event => {\n      const pokemonName = this.state.selected.name\n      this.setState({ favorite: event.target.checked });\n      if (event.target.checked) {\n        //Add element to favorites\n        this.setState(prevState => ({\n          favorites: [...prevState.favorites, prevState.selected.id]\n        }))\n\n        request\n          .post(`${baseUrl}/users/${this.props.currentUser.userId}`)\n          .query({ name: pokemonName })\n          .then(response => {\n            console.log(`Pokemon ${pokemonName} added as favorite`)\n          })\n      } else {\n        //Remove element from favorites\n        this.setState({ favorites: this.state.favorites.filter(fav => fav !== this.state.selected.id )})\n        \n        request\n          .del(`${baseUrl}/users/${this.props.currentUser.userId}`)\n          .query({ name: pokemonName })\n          .then(response => {\n            console.log(`Pokemon ${pokemonName} removed from favorites`)\n          })\n      }\n    }\n\n    checkFavorite = selected => {\n      request(`${baseUrl}/pokemons/favorites/${this.props.currentUser.userId}`)\n        .then(response => {\n          const favorites = response.body.favorites.map(elem => (elem.pokemonId))\n          if (favorites.includes(selected.id)) {\n            this.setState({ favorite: true })\n          } else {\n            this.setState({ favorite: false })\n          }\n        })\n    }\n\n\n    loggingOut = () => {\n      this.props.logout()\n    }\n\n\n    generatePdf = () => {\n      const doc = new jsPDF()\n      doc.text(`Id: ${this.state.selected.id}`, 10, 10)\n      doc.text(`Name: ${this.state.selected.name}`, 10, 20)\n      doc.text(`Weight: ${this.state.selected.weight}`, 10, 30)\n      doc.text(`Height: ${this.state.selected.height}`, 10, 40)\n      doc.text(`Base experience: ${this.state.selected.base_experience}`, 10, 50)\n      doc.text(`Image URL: ${this.state.selected.image}`, 10, 60, { maxWidth: \"180\" })\n      doc.text(`Favorite: ${this.state.favorite}`, 10, 80)\n      doc.save('pokemon_details.pdf')\n    }\n\n\n    render() {\n      const { classes } = this.props\n\n      if (!this.state.pokemons) return \"Loading...\"\n\n      return (\n        <div>\n          <Grid container className={classes.container} justify=\"space-evenly\">\n            <Grid item>\n              <Grid container className={classes.container} direction=\"column\">\n                <Grid item>\n                  <PokemonSearchForm handleSubmit={this.handleSubmit} handleChange={this.handleChange} />\n                </Grid>\n\n                <Grid item>\n                  <Grid container>\n                    <PokemonList pokemons={this.state.pokemons} showDetails={this.showDetails}\n                      favorites={this.state.favorites} />\n                  </Grid>\n                </Grid>\n\n              </Grid>\n            </Grid>\n\n            <Grid item>\n              <Grid container direction=\"column\">\n                <Grid item>\n                  <UserSection loggingOut={this.loggingOut} currentUser={this.props.currentUser} />\n                </Grid>\n\n                <Grid item className={classes.paper}>\n                  <PokemonDetails selected={this.state.selected} changeFavorite={this.changeFavorite}\n                    favorite={this.state.favorite} currentUser={this.props.currentUser}\n                    generatePdf={this.generatePdf} />\n                </Grid>\n              </Grid>\n\n            </Grid>\n          </Grid>\n        </div>)\n    }\n  }\n)\n\nconst mapStateToProps = function (state) {\n  return {\n    currentUser: state.currentUser,\n    error: state.login.error\n  }\n}\n\nconst mapDispatchToProps = { logout }\n\nexport default connect(mapStateToProps, mapDispatchToProps)(PokemonContainer)"]},"metadata":{},"sourceType":"module"}